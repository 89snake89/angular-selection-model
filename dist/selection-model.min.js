angular.module("selectionModel",[]),angular.module("selectionModel").directive("selectionModel",["selectionStack","uuidGen",function(a,b){"use strict";return{restrict:"A",link:function(c,d,e){var f="selected",g="selected",h="basic",i="single",j=e.selectionModelType||h,k=e.selectionModelMode||i,l=/^multi(ple)?$/.test(k),m=e.selectionModelSelectedAttribute||f,n=e.selectionModelSelectedClass||g,o=e.ngRepeat;if(!o)throw"selectionModel must be used along side ngRepeat";var p=function(){if(!l)return null;var a="data-selection-model-stack-id",c=d.attr(a);return c?c:(c=d.parent().attr(a))?(d.attr(a,c),c):(c=b.create(),d.attr(a,c),d.parent().attr(a,c),c)}(),q=o.split(" in "),r=c.$eval(q[0]),s=function(){if(r[m]?d.addClass(n):d.removeClass(n),"checkbox"===j){var a=d.find("input");a.prop("checked",r[m])}},t=function(){return c.$eval(q[1])},u=function(){angular.forEach(t(),function(a){a[m]=!1})},v=function(a){var b=(t(),!1),c=!1;a=a||r,angular.forEach(t(),function(d){c=c||d===r,b=b||d===a;var e=b+c===1;(e||d===r||d===a)&&(d[m]=!0)})};d.on("click",function(b){var d=b.ctrlKey||b.metaKey,e=b.shiftKey;if(e&&/^multi(ple)?$/.test(k))return d||u(),v(a.peek(p)),c.$apply(s),void 0;if(d||e){var f=!r[m];return/^multi(ple)?$/.test(k)||u(),r[m]=f,r[m]&&a.push(p,r),c.$apply(s),void 0}u(),r[m]=!0,a.push(p,r),c.$apply(s)}),s(),c.$watch(q[0]+"."+m,function(a,b){l||!a||b||(u(),r[m]=!0),s()})}}}]),angular.module("selectionModel").service("selectionStack",function(){"use strict";var a={},b=1e3,c={};return a.push=function(a,d){c.hasOwnProperty(a)||(c[a]=[]);var e=c[a];for(e.push(d);e.length>b;)e.shift();return e.length},a.pop=function(a){c.hasOwnProperty(a)||(c[a]=[]);var b=c[a];return b.pop()},a.peek=function(a){c.hasOwnProperty(a)||(c[a]=[]);var b=c[a];return b.length?b[b.length-1]:void 0},a}),angular.module("selectionModel").service("uuidGen",function(){"use strict";var a={};return a.create=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"===a?b:3&b|8;return c.toString(16)})},a});