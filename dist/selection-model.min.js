angular.module("selectionModel",[]),angular.module("selectionModel").directive("selectionModel",["selectionStack","uuidGen",function(a,b){"use strict";return{restrict:"A",link:function(c,d,e){var f="selected",g="selected",h="basic",i="single",j=e.selectionModelType||h,k=e.selectionModelMode||i,l=/^multi(ple)?(-additive)?$/.test(k),m=/^multi(ple)?-additive/.test(k),n=e.selectionModelSelectedAttribute||f,o=e.selectionModelSelectedClass||g,p=e.ngRepeat;if(!p)throw"selectionModel must be used along side ngRepeat";var q=function(){if(!l)return null;var a="data-selection-model-stack-id",c=d.attr(a);return c?c:(c=d.parent().attr(a))?(d.attr(a,c),c):(c=b.create(),d.attr(a,c),d.parent().attr(a,c),c)}(),r=p.split(" in "),s=c.$eval(r[0]),t=function(){if(s[n]?d.addClass(o):d.removeClass(o),"checkbox"===j){var a=d.find("input");a.prop("checked",s[n])}},u=function(){return c.$eval(r[1])},v=function(){return c.$eval(r[1].split("|")[0])},w=function(){angular.forEach(v(),function(a){a[n]=!1})},x=function(a){var b=(u(),!1),c=!1;a=a||s,angular.forEach(u(),function(d){c=c||d===s,b=b||d===a;var e=b+c===1;(e||d===s||d===a)&&(d[n]=!0)})};d.on("click",function(b){var d=b.ctrlKey||b.metaKey||m,e=b.shiftKey;if(e&&l)return d||w(),x(a.peek(q)),c.$apply(t),void 0;if(d||e){var f=!s[n];return l||w(),s[n]=f,s[n]&&a.push(q,s),c.$apply(t),void 0}w(),s[n]=!0,a.push(q,s),c.$apply(t)}),t(),c.$watch(r[0]+"."+n,function(a,b){l||!a||b||(w(),s[n]=!0),t()})}}}]),angular.module("selectionModel").service("selectionStack",function(){"use strict";var a={},b=1e3,c={};return a.push=function(a,d){c.hasOwnProperty(a)||(c[a]=[]);var e=c[a];for(e.push(d);e.length>b;)e.shift();return e.length},a.pop=function(a){c.hasOwnProperty(a)||(c[a]=[]);var b=c[a];return b.pop()},a.peek=function(a){c.hasOwnProperty(a)||(c[a]=[]);var b=c[a];return b.length?b[b.length-1]:void 0},a}),angular.module("selectionModel").service("uuidGen",function(){"use strict";var a={};return a.create=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"===a?b:3&b|8;return c.toString(16)})},a});