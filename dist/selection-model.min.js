angular.module("selectionModel",[]),angular.module("selectionModel").directive("selectionModel",["selectionStack","uuidGen","selectionModelOptions",function(a,b,c){"use strict";return{restrict:"A",link:function(d,e,f){var g=c.get(),h=g.selectedAttribute,i=g.selectedClass,j=g.type,k=g.mode,l=f.selectionModelType||j,m=f.selectionModelMode||k,n=/^multi(ple)?(-additive)?$/.test(m),o=/^multi(ple)?-additive/.test(m),p=f.selectionModelSelectedAttribute||h,q=f.selectionModelSelectedClass||i,r=f.ngRepeat;if(!r)throw"selectionModel must be used along side ngRepeat";var s=function(){if(!n)return null;var a="data-selection-model-stack-id",c=e.attr(a);return c?c:(c=e.parent().attr(a))?(e.attr(a,c),c):(c=b.create(),e.attr(a,c),e.parent().attr(a,c),c)}(),t=r.split(" in "),u=d.$eval(t[0]),v=function(){if(u[p]?e.addClass(q):e.removeClass(q),"checkbox"===l){var a=e.find("input");a.prop("checked",u[p])}},w=function(){return d.$eval(t[1])},x=function(){return d.$eval(t[1].split("|")[0])},y=function(){angular.forEach(x(),function(a){a[p]=!1})},z=function(a){var b=(w(),!1),c=!1;a=a||u,angular.forEach(w(),function(d){c=c||d===u,b=b||d===a;var e=b+c===1;(e||d===u||d===a)&&(d[p]=!0)})};e.on("click",function(b){var c=b.ctrlKey||b.metaKey||o,e=b.shiftKey;if(e&&n)return c||y(),z(a.peek(s)),d.$apply(v),void 0;if(c||e){var f=!u[p];return n||y(),u[p]=f,u[p]&&a.push(s,u),d.$apply(v),void 0}y(),u[p]=!0,a.push(s,u),d.$apply(v)}),v(),d.$watch(t[0]+"."+p,function(a,b){n||!a||b||(y(),u[p]=!0),v()})}}}]),angular.module("selectionModel").provider("selectionModelOptions",[function(){"use strict";var a={selectedAttribute:"selected",selectedClass:"selected",type:"basic",mode:"single"};this.set=function(b){angular.extend(a,b)},this.$get=function(){var b={get:function(){return angular.copy(a)}};return b}}]),angular.module("selectionModel").service("selectionStack",function(){"use strict";var a={},b=1e3,c={};return a.push=function(a,d){c.hasOwnProperty(a)||(c[a]=[]);var e=c[a];for(e.push(d);e.length>b;)e.shift();return e.length},a.pop=function(a){c.hasOwnProperty(a)||(c[a]=[]);var b=c[a];return b.pop()},a.peek=function(a){c.hasOwnProperty(a)||(c[a]=[]);var b=c[a];return b.length?b[b.length-1]:void 0},a}),angular.module("selectionModel").service("uuidGen",function(){"use strict";var a={};return a.create=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"===a?b:3&b|8;return c.toString(16)})},a});